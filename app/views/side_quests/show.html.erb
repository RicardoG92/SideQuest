<div class = "sidequest-photo">
  <div style="width: 100%; height: 250px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%=  ENV['MAPBOX_API_KEY'] %>" >
  </div>
</div>

<div class="sidequest-card cards container">
  <div class = "list-group-item" >
    <p>Name:<%= @sidequest.name %></p>
    <p>Address:<%= @sidequest.address %></p>
  </div>
  <% if !@sidequest.reviews.empty?%>
    <% @sidequest.reviews.each do |review| %>
        <li class='list-group-item'>
          <small>
            <% count = 0 %>
            <% 5.times do %>
              <% if review.rating > count %>
                <i class="fa-solid fa-star"></i>
              <% else %>
                <i class="fa-light fa-star"></i>
              <% end %>
              <% count += 1 %>
            <% end %>
          </small>
          <p><%= review.body %></p>
        </li>
        <button class="btn-flat" data-bs-target="#exampleModalToggle2" data-bs-toggle="modal">See More Reviews</button>
        <button class="btn-flat" data-bs-toggle="modal" href="#exampleModalToggle" role="button">Add a Review</button>
        <%= link_to 'Back',side_quests_path(@sidequest), class: 'btn-flat text-center' %>
    <% end %>
  <% else %>
    <div class = 'cards container'>
      <p> There are no reviews for this sidequest as of yet, be the first to experience it and tell us how it went</p>
    </div>
    <div class = 'list-group-item'>
      <button class="btn-flat" data-bs-toggle="modal" href="#exampleModalToggle" role="button">Add a Review</button>
      <%= link_to 'Back',side_quests_path(@sidequest), class: 'btn-flat' %>
    </div>
  <% end %>
</div>

<div class="modal fade" id="exampleModalToggle" aria-labelledby="exampleModalToggleLabel" tabindex="-1" style="display: none;" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalToggleLabel">New review</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= simple_form_for [@sidequest, @review] do |f| %>
          <%= f.input :rating, collection: 0..5 %>
          <%= f.input :body%>
          <%= f.submit class: 'btn-flat' %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalToggleLabel2">Reviews</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <% @sidequest.reviews.each do |review| %>
          <li class='list-group-item'>
            <small>
              <% count = 0 %>
              <% 5.times do %>
                <% if review.rating > count %>
                  <i class="fa-solid fa-star"></i>
                <% else %>
                  <i class="fa-regular fa-star"></i>
                <% end %>
                <% count += 1 %>
              <% end %>
            </small>
            <p><%= review.body %></p>
          </li>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class = "footer-info text-center">
  <div class = "btn">
    <%#= link_to 'Add', new_side_quest_path(@trip) %>
  </div>
</div>
<%# route to stops %>
